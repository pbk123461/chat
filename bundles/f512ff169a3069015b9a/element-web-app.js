(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1367:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(1),r=n.n(a),o=n(0),i=n.n(o),s=n(25),l=n(1360);var c=()=>{var e;const t=s.b.getObject("branding"),n=null!==(e=null==t?void 0:t.get("auth_footer_links"))&&void 0!==e?e:[{text:"Blog",url:"https://element.io/blog"},{text:"Twitter",url:"https://twitter.com/element_hq"},{text:"GitHub",url:"https://github.com/vector-im/element-web"}],a=[];for(const e of n)a.push(i.a.createElement("a",{href:e.url,key:e.text,target:"_blank",rel:"noreferrer noopener"},e.text));return i.a.createElement("footer",{className:"mx_AuthFooter",role:"contentinfo"},a,i.a.createElement("a",{href:"https://matrix.org",target:"_blank",rel:"noreferrer noopener"},Object(l.b)("powered_by_matrix")))};class d extends o.PureComponent{static getWelcomeBackgroundUrl(){if(d.welcomeBackgroundUrl)return d.welcomeBackgroundUrl;const e=s.b.getObject("branding");d.welcomeBackgroundUrl="themes/element/img/backgrounds/lake.jpg";const t=null==e?void 0:e.get("welcome_background_url");if(t)if(Array.isArray(t)){const e=Math.floor(Math.random()*t.length);d.welcomeBackgroundUrl=t[e]}else d.welcomeBackgroundUrl=t;return d.welcomeBackgroundUrl}render(){const e={background:`center/cover fixed url(${d.getWelcomeBackgroundUrl()})`},t={position:"absolute",top:0,right:0,bottom:0,left:0,filter:"blur(40px)",background:e.background};return o.createElement("div",{className:"mx_AuthPage",style:e},o.createElement("div",{className:"mx_AuthPage_modal",style:{position:"relative",background:"initial"}},o.createElement("div",{className:"mx_AuthPage_modalBlur",style:t}),o.createElement("div",{className:"mx_AuthPage_modalContent",style:{display:"flex",zIndex:1,background:"rgba(255, 255, 255, 0.59)",borderRadius:"8px"}},this.props.children)),o.createElement(c,null))}}r()(d,"welcomeBackgroundUrl",void 0)},1591:function(e,t,n){var a={"./":[426,9],"./ICanvasEffect":[1493,7,11],"./ICanvasEffect.ts":[1493,7,11],"./confetti":[1391,9,1],"./confetti/":[1391,9,1],"./confetti/index":[1391,9,1],"./confetti/index.ts":[1391,9,1],"./effect":[1494,9,12],"./effect.ts":[1494,9,12],"./fireworks":[1392,9,2],"./fireworks/":[1392,9,2],"./fireworks/index":[1392,9,2],"./fireworks/index.ts":[1392,9,2],"./hearts":[1393,9,3],"./hearts/":[1393,9,3],"./hearts/index":[1393,9,3],"./hearts/index.ts":[1393,9,3],"./index":[426,9],"./index.ts":[426,9],"./rainfall":[1394,9,4],"./rainfall/":[1394,9,4],"./rainfall/index":[1394,9,4],"./rainfall/index.ts":[1394,9,4],"./snowfall":[1395,9,5],"./snowfall/":[1395,9,5],"./snowfall/index":[1395,9,5],"./snowfall/index.ts":[1395,9,5],"./spaceinvaders":[1396,9,6],"./spaceinvaders/":[1396,9,6],"./spaceinvaders/index":[1396,9,6],"./spaceinvaders/index.ts":[1396,9,6],"./utils":[660,9],"./utils.ts":[660,9]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(2).map(n.e)).then((function(){return n.t(r,t[1])}))}r.keys=function(){return Object.keys(a)},r.id=1591,e.exports=r},1602:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0),r=n(25);class o extends a.PureComponent{render(){var e;const t=r.b.getObject("branding"),n=null!==(e=null==t?void 0:t.get("auth_header_logo_url"))&&void 0!==e?e:"themes/element/img/logos/element-logo.svg";return a.createElement("aside",{className:"mx_AuthHeaderLogo"},a.createElement("img",{src:n,alt:"Element"}))}}},1715:function(e,t,n){"use strict";n.r(t),n.d(t,"loadApp",(function(){return C}));n(1530);var a=n(0),r=n.n(a),o=n(74),i=n(1370),s=n(446),l=n(1382),c=n(25),d=n(3),u=n(4),g=n(261),f=n(1540),m=n(1638),w=n(429),h=n(676);let _=null;function v(e){const t=Object(h.b)(e);return{screen:t.location.substring(1),params:t.params}}function p(){decodeURIComponent(window.location.hash)!==_&&function(e){if(!window.matrixChat)return;d.a.log("Routing URL ",e.href);const t=v(e);window.matrixChat.showScreen(t.screen,t.params)}(window.location)}function b(e,t=!1){d.a.log("newscreen "+e);const n="#/"+e;_=n,e.startsWith("room/")&&window.location.hash.includes("/$")===n.includes("/$")&&window.location.hash.startsWith(n)&&(t=!0),t?window.location.replace(n):window.location.assign(n)}const x="mx_screen_after_login";function k(e){const t=v(e);(t.screen||t.params)&&function(e){null!=e&&e.screen&&sessionStorage.setItem(x,JSON.stringify(e))}(t);const n=function(){const e=sessionStorage.getItem(x);return e?JSON.parse(e):void 0}();return n}var y=n(1360);function U(){const e=new URL(window.location.href);e.searchParams.delete("loginToken"),e.searchParams.delete("state"),e.searchParams.delete("code"),d.a.log(`Redirecting to ${e.href} to drop delegated authentication params from queryparams`),window.history.replaceState(null,"",e.href)}async function C(e,t){var n;window.addEventListener("hashchange",p);const a=o.a.get(),_=Object(h.a)(window.location),x=window.location.protocol+"//"+window.location.host+window.location.pathname;d.a.log("Vector starting at "+x),a.startUpdater();const C=await async function(){let e;try{d.a.log("Verifying homeserver configuration");const t=c.b.get();let n=t.default_server_config;const a=t.default_server_name,r=t.default_hs_url,o=t.default_is_url,l=[n,a,r].filter((e=>!!e));if(r&&(n||a))throw new y.a("error|invalid_configuration_mixed_server");if(l.length<1)throw new y.a("error|invalid_configuration_no_server");let u;r&&(d.a.log("Config uses a default_hs_url - constructing a default_server_config using this information"),d.a.warn("DEPRECATED CONFIG OPTION: In the future, default_hs_url will not be accepted. Please use default_server_config instead."),n={"m.homeserver":{base_url:r}},o&&(n["m.identity_server"]={base_url:o})),!a&&n&&(d.a.log("Config uses a default_server_config - validating object"),u=await s.a.fromDiscoveryConfig(n)),a&&(d.a.log("Config uses a default_server_name - doing .well-known lookup"),d.a.warn("DEPRECATED CONFIG OPTION: In the future, default_server_name will not be accepted. Please use default_server_config instead."),u=await s.a.findClientConfig(a),null===u["m.homeserver"].base_url&&n&&(d.a.log("Finding base_url failed but a default_server_config was found - using it as a fallback"),u=await s.a.fromDiscoveryConfig(n))),e=i.a.buildValidatedConfigFromDiscovery(a,u,!0)}catch(t){const{hsUrl:n,isUrl:a,userId:r}=await l.c();if(!n||!r)throw t;d.a.error(t),d.a.warn("A session was found - suppressing config error and using the session's homeserver"),d.a.log("Using pre-existing hsUrl and isUrl: ",{hsUrl:n,isUrl:a}),e=await i.a.validateServerConfigWithStaticUrls(n,a,!0)}return e.isDefault=!0,d.a.log("Using homeserver config:",e),d.a.log("Updating SdkConfig with validated discovery information"),c.b.add({validated_server_config:e}),c.b.get()}(),E=new g.a(C),[O]=await l.b(),P=!!O,N=!!_.loginToken,D=Object(c.c)(C);let S=!0===D.immediate;const A="#/welcome"===window.location.hash||"#"===window.location.hash||""===window.location.hash;if(!S&&D.on_welcome_page&&A&&(S=!0),!P&&!N&&S){d.a.log("Bypassing app load to redirect to SSO");const e=Object(u.createClient)({baseUrl:C.validated_server_config.hsUrl,idBaseUrl:C.validated_server_config.isUrl});return o.a.get().startSingleSignOn(e,"sso",`/${v(window.location).screen}`),r.a.createElement(r.a.Fragment,null)}const B=null!==(n=E.get("default_device_display_name"))&&void 0!==n?n:null==a?void 0:a.getDefaultDeviceDisplayName(),I=k(window.location),j={Wrapper:r.a.Fragment};return w.a.instance.invoke(m.WrapperLifecycle.Wrapper,j),r.a.createElement(j.Wrapper,null,r.a.createElement(f.a,{ref:t,onNewScreen:b,config:C,realQueryParams:_,startingFragmentQueryParams:e,enableGuest:!C.disable_guests,onTokenLoginCompleted:U,initialScreenAfterLogin:I,defaultDeviceDisplayName:B}))}window.React=r.a,d.a.log("Application is running in production mode"),window.matrixLogger=d.a}}]);
//# sourceMappingURL=element-web-app.js.map